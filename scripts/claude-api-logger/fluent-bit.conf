# Fluent Bit Configuration for Claude API Logger
# Ships logs from claude-code-logger to Seq via OTLP

[SERVICE]
    flush           5
    daemon          off
    log_level       info
    parsers_file    /etc/fluent-bit/parsers.conf

# Read logs from claude-code-logger output
[INPUT]
    name            tail
    path            /var/log/claude-api.log
    tag             claude.api
    refresh_interval 1
    read_from_head  true

# Add metadata
[FILTER]
    name            record_modifier
    match           *
    record          service claude-api-logger
    record          source api-proxy

# Output to Seq via OTLP HTTP
# SEQ_HOST is set by entrypoint.sh (defaults to host.containers.internal)
[OUTPUT]
    name            opentelemetry
    match           *
    host            ${SEQ_HOST}
    port            5341
    logs_uri        /ingest/otlp/v1/logs
    tls             off
    add_label       app claude-api-logger
    add_label       environment sandbox
